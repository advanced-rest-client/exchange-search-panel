<script>
(function() {
  'use strict';

  window.ArcBehaviors = window.ArcBehaviors || {};
  /**
   * Common methods for list items.
   *
   * @polymerBehavior ArcBehaviors.ExchangeSearchItemBehavior
   */
  window.ArcBehaviors.ExchangeSearchItemBehavior = {
    properties: {
      /**
       * REST API index datastore object
       */
      item: Object,
      /**
       * If true, the element will not produce a ripple effect when interacted
       * with via the pointer.
       */
      noink: Boolean,
      /**
       * Computed value from `item` property.
       * List of tags to display.
       */
      tags: {
        type: Array,
        computed: '_computeTags(item.*)'
      },
      /**
       * Computed value, true if the API item has tags.
       */
      hasTags: {
        type: Boolean,
        computed: '_computeHasTags(tags)'
      },
      /**
       * Main action button of an item.
       */
      actionLabel: {
        type: String,
        value: 'Download'
      }
    },
    /**
     * Computes tags label value form item's tags
     */
    _computeTags: function(record) {
      if (!record || !record.base || !record.base.tags) {
        return '';
      }
      var has = !!(record.base.tags.length);
      if (!has) {
        return '';
      }
      return record.base.tags.map(item => item.value).join(', ');
    },
    /**
     * Computes `hasTags` property.
     */
    _computeHasTags: function(tags) {
      return !!tags;
    },
    // Computes value for `iron-icon` src property from current item.
    _computeIconSrc: function(item) {
      if (!item || !item.icon) {
        return;
      }
      return item.icon;
    },
    // Computes value for `iron-icon` icon property from current item.
    _computeIconIcon: function(item) {
      if (item && item.icon) {
        return;
      }
      return 'arc:raml-r';
    },

    /**
     * Dispatches the `download` custom event to inform the panel
     * about user action.
     */
    requestDownload: function() {
      this.fire('download', {}, {
        bubbles: false
      });
    }

    /**
     * Dispatched when the user requested to download the API.
     *
     * The event does not bubble.
     *
     * @event download
     */
  };
})();
</script>
